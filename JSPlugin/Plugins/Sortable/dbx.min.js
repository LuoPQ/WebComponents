function dbxManager(n,t,i,r){if(dbx=this,!/^[-_a-z0-9]+$/i.test(n))throw'Error from dbxManager:\n"'+n+'" is an invalid session ID';if(this.kde=navigator.vendor=="KDE",this.safari=navigator.vendor=="Apple Computer, Inc.",this.chrome=navigator.vendor=="Google Inc.",this.opera=typeof opera!="undefined",this.msie=typeof document.uniqueID!="undefined",this.supported=!(typeof document.getElementsByTagName=="undefined"||document.getElementsByTagName("*").length==0||this.kde&&typeof sidebar=="undefined"||this.opera&&parseFloat(navigator.userAgent.toLowerCase().split(/opera[\/ ]/)[1].split(" ")[0],10)<8),this.supported){if(this.etype=typeof document.addEventListener!="undefined"?"addEventListener":typeof document.attachEvent!="undefined"?"attachEvent":"none",this.etype=="none"){this.supported=!1;return}this.eprefix=this.etype=="attachEvent"?"on":"";this.sid=n;this.cookiename="dbx-"+this.sid+"=";this.useid=typeof t!="undefined"&&t=="yes"?!0:!1;this.hide=typeof i!="undefined"&&i=="no"?!1:!0;this.buttontype=typeof r!="undefined"&&r=="button"?"button":"link";this.running=0;this.gnumbers={};this.max=0;this.rootcookie="";document.cookie&&document.cookie.indexOf(this.cookiename)!=-1&&(this.rootcookie=document.cookie.split(this.cookiename)[1].split(";")[0],this.rootcookie=this.rootcookie.replace(/\|/g,",").replace(/:/g,"="),this.rootcookie.indexOf("+")==-1&&(this.rootcookie=this.rootcookie.replace(/(,|$|&)/ig,"+$1").replace(/(\-\+)/g,"-")));this.savedata={};this.cookiestate=this.getCookieState()}}function dbxGroup(){var n,i,t;if(dbx.supported){if(n=arguments,!/^[-_a-z0-9]+$/i.test(n[0])||n[0]=="deleted")throw'Error from dbxGroup:\n"'+n[0]+'" is an invalid container ID';if(this.container=dbx.get("#"+n[0]),!dbx.hasClass(this.container,"dbx-group"))throw'Error from dbxGroup:\nGroup container (the element with id="'+n[0]+'") must contain the class name "dbx-group"';if(this.container){if(this.gid=n[0],this.cacheDynamicClasses(),typeof dbx.onbeforestatechange!="undefined"&&(i=dbx.compileAndDispatchOnBeforeStateChange(["proceed",this,this.container,this.gid,null,null,"load"]),!i.proceed)){this.container=null;return}this.orientation=/^(freeform|confirm|horizontal|vertical|insert(\-swap|\-insert)?)/.test(n[1])?n[1]:"freeform";this.orientation=="insert"&&(this.orientation="freeform-insert");this.exchange="swap";/(freeform|confirm)\-insert/.test(this.orientation)&&(this.exchange="insert");this.orientation=this.orientation.split("-")[0];this.confirm=!1;this.orientation=="confirm"&&(this.confirm=!0,this.orientation="freeform");this.threshold=parseInt(n[2],10);isNaN(this.threshold)&&(this.threshold=0);this.restrict=n[3]=="yes"?this.orientation:"";this.resolution=parseInt(n[4],10);isNaN(this.resolution)&&(this.resolution=0);this.resolution==0&&(this.resolution=1);this.toggles=n[5]=="yes";this.defopen=n[6]!="closed";this.vocab={open:n[7],close:n[8],move:n[9],toggle:n[10],kmove:n[11],ktoggle:n[12],syntax:n[13],kyes:typeof n[14]!="undefined"?n[14]:"",kno:typeof n[15]!="undefined"?n[15]:""};t=this;this.dragok=!1;this.box=null;this.dialog=null;this.buffer=null;this.last={box:null,direction:null};this.child={first:null,last:null};this.keytimer=null;this.currentdir=null;this.rules={global:{pointer:0,rule:[],actual:[]}};this.rulekey="";this.ruledir="";this.container.style.position="relative";this.container.style.display="block";this.initBoxes(!0,!0);this.keydown=!1;this.mouseisdown=!1;dbx.addEvent(document,"mouseout",function(n){typeof n.target=="undefined"&&(n.relatedTarget=n.toElement);n.relatedTarget==null&&t.mouseup(n)});dbx.addEvent(document,"mousemove",function(n){return t.hover(n),t.mousemove(n),!t.dragok});dbx.addEvent(document,"mousedown",function(){t.mouseisdown=!0});dbx.addEvent(document,"mouseup",function(n){t.mouseisdown=!1;t.mouseup(n)});dbx.addEvent(document,"keydown",function(n){t.keydown=!0;t.dialog&&!/^((3[7-9])|40|13|(1[6-8]))$/.test(n.keyCode)&&t.clearDialog()});dbx.addEvent(document,"keyup",function(){t.keydown=!1;t.currentdir=null;t.removeActiveClasses("dbx-box-active")})}}}function dbxAnimator(n,t,i,r,u,f,e){var o,s,h,c;if(this.caller=n,this.caller.resolution==0&&(this.caller.resolution=1),this.box=t,this.timer=null,o={x:i.x,y:i.y},s={x:this.box.offsetLeft,y:this.box.offsetTop},!(o.x==s.x&&o.y==s.y)){if(dbx.running>this.caller.boxes.length-1)return;h=this.caller.createClone(this.box,29999,arguments[2],"dbx-aniclone",!0,"animator");h.style.visibility="visible";this.box.style.visibility="hidden";c={x:s.x>o.x?s.x-o.x:0-(o.x-s.x),y:s.y>o.y?s.y-o.y:0-(o.y-s.y)};this.animateClone(h,o,c,r,u,f,e)}}var dbx;dbxManager.prototype.setCookieState=function(){var n=new Date;n.setTime(n.getTime()+31536e6);this.compileStateString();this.cookiestring=this.state.replace(/,/g,"|").replace(/=/g,":").replace(/\+/g,"");(typeof this.onstatechange=="undefined"||this.onstatechange())&&(document.cookie=this.cookiename+this.cookiestring+"; expires="+n.toGMTString()+"; path=/")};dbxManager.prototype.getCookieState=function(){if(this.cookiestate=null,document.cookie&&document.cookie.indexOf(this.cookiename)!=-1){this.cookie=document.cookie.split(this.cookiename)[1].split(";")[0].split("&");for(var n in this.cookie)this.unwanted(this.cookie,n)||(this.cookie[n]=this.cookie[n].replace(/\|/g,","),this.cookie[n]=this.cookie[n].replace(/:/g,"="),this.cookie[n].indexOf("+")==-1&&(this.cookie[n]=this.cookie[n].replace(/(,|$|&)/ig,"+$1").replace(/(\-\+)/g,"-")),this.cookie[n]=this.cookie[n].split("="),this.cookie[n][1]=this.cookie[n][1].split(","));this.cookiestate={};for(n in this.cookie)this.unwanted(this.cookie,n)||(this.cookiestate[this.cookie[n][0]]=this.cookie[n][1])}return this.cookiestate};dbxManager.prototype.compileStateString=function(){var t="";for(var n in this.savedata)this.unwanted(this.savedata,n)||(t+=n+"="+this.savedata[n]+"&");this.state=t.replace(/^(.+)&$/,"$1")};dbxManager.prototype.createElement=function(n){return typeof document.createElementNS!="undefined"?document.createElementNS("http://www.w3.org/1999/xhtml",n):document.createElement(n)};dbxManager.prototype.getTarget=function(n,t,i){if(typeof i!="undefined")var r=i;else r=typeof n.target!="undefined"?n.target:n.srcElement;while(!this.hasClass(r,t))if(r=r.parentNode,this.hasClass(r,"dbx-group")&&!this.hasClass(r,t))return null;return r};dbxManager.prototype.getID=function(n){if(n&&n.className){if(this.hasClass(n,"dbx-dummy"))return"dummy"}else return null;var t=n.className.split("dbxid-");return t.length==1?null:t[1].replace(/^([a-zA-Z0-9_]+).*$/,"$1")};dbxManager.prototype.getSiblingBox=function(n,t){for(var i=n[t];i&&!this.hasClass(i,"dbx-box");)i=i[t];return i||(i=n),i};dbxManager.prototype.getPosition=function(n,t){for(var i={left:n.offsetLeft,top:n.offsetTop},r=n.offsetParent;r;)i.left+=r.offsetLeft,i.top+=r.offsetTop,r=r.offsetParent;return t&&(i.left+=n.offsetWidth/2,i.top+=n.offsetHeight/2),i};dbxManager.prototype.getViewportWidth=function(){return typeof innerWidth!="undefined"?window.innerWidth:typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0?document.documentElement.clientWidth:this.get("body")[0].clientWidth};dbxManager.prototype.compileAndDispatchOnBeforeStateChange=function(){for(var n,i={},t=0;t<arguments.length;t++)n=arguments[t],this.dbxobject=n[1],this.group=n[2],this.gid=n[3],this.sourcebox=n[4],this.target=n[5],this.action=n[6],i[n[0]]=this.onbeforestatechange();return i};dbxManager.prototype.compileAndDispatchOnAnimate=function(n,t,i,r,u){dbx.sourcebox=n;dbx.clonebox=t;dbx.dbxobject=i;dbx.group=i.container;dbx.anicount=r-1;dbx.anilength=u-1;dbx.onanimate()};dbxManager.prototype.compileAndDispatchOnAfterAnimate=function(n,t){dbx.sourcebox=n;dbx.dbxobject=t;dbx.group=t.container;dbx.onafteranimate()};dbxManager.prototype.unwanted=function(n,t){return!n.hasOwnProperty(t)||typeof n[t]=="undefined"||typeof n[t]=="function"||t=="length"};dbxManager.prototype.addEvent=function(n,t,i){n[this.etype](this.eprefix+t,i,!1)};dbxManager.prototype.trim=function(n){return n.replace(/^\s+|\s+$/g,"")};dbxManager.prototype.empty=function(n){var t,i;if(typeof n=="string"&&this.trim(n)==="")return!0;if(typeof n=="object"){if(n instanceof Array&&n.length==0)return!0;t=0;for(i in n)n.hasOwnProperty(i)&&t++;if(t==0)return!0}return!1};dbxManager.prototype.hasClass=function(n,t){return n.className&&new RegExp(t+"($|[ ])").test(n.className)};dbxManager.prototype.removeClass=function(n,t){return typeof flags=="undefined"&&(flags=""),n.className=n.className.replace(new RegExp(t,"g"),""),/\S/.test(n.className)||(n.className=""),n};dbxManager.prototype.get=function(n,t){if(/(previous|next|first|last)(Sibling|Child)/.test(n)){t=t[n];switch(n){case"nextSibling":case"previousSibling":while(t&&t.nodeType!=1)t=t[n]}return t}return n.indexOf("#")!=-1?document.getElementById(n.split("#")[1]):(typeof t=="undefined"&&(t=document),t.getElementsByTagName(n))};dbxGroup.prototype.initBoxes=function(n){var i,t,r,o,f,s,u,h,e;for(this.boxes={length:0},this.handles=[],this.buttons={},this.order=[],i=this,this.eles=dbx.get("*",this.container),t=0;t<this.eles.length;t++){if(r=this.boxes.length,dbx.hasClass(this.eles[t],"dbx-box")&&!dbx.hasClass(this.eles[t],"dbx-(dummy|clone)")){if(dbx.useid)if(/^[a-z][a-z0-9]*$/i.test(this.eles[t].id)&&!/^(length|dummy)$/.test(this.eles[t].id))r=this.eles[t].id;else if(this.eles[t].id!="")throw'Error from dbxGroup:\n"'+this.eles[t].id+'" is an invalid box ID';if(this.boxes[r]=this.eles[t],this.boxes.length++,this.order.push(r+"+"),typeof this.eles[t].hashandlers=="undefined"&&(dbx.addEvent(this.eles[t],"mousedown",function(n){n||(n=window.event);i.mousedown(n,dbx.getTarget(n,"dbx-box"))}),this.eles[t].hashandlers=!0),typeof this.eles[t].processed!="undefined")continue;this.eles[t].style.position="relative";this.eles[t].style.display="block";this.eles[t].className+=" dbx-box-open";this.eles[t].className+=" dbxid-"+r;this.eles[t].processed=!0}if(dbx.hasClass(this.eles[t],"dbx-handle")){if(this.handles.push(this.eles[t]),o=dbx.getTarget(null,"dbx-box",this.eles[t]),this.toggles?(r=dbx.getID(o),this.buttons[r]=this.addToggleBehavior(this.eles[t])):typeof this.eles[t].hashandlers=="undefined"&&(f=this.eles[t],f.hasfocus=dbx.opera||dbx.safari?null:!1,dbx.hasClass(o,"dbx-nograb")||(dbx.addEvent(f,"key"+(dbx.msie||dbx.safari||dbx.chrome?"down":"press"),function(n){return n||(n=window.event),i.keypress(n,dbx.getTarget(n,"dbx-handle"))}),dbx.addEvent(f,"click",function(n){if(i.dialog)if(i.click(n,dbx.getTarget(n,"dbx-handle")),typeof n.preventDefault!="undefined")n.preventDefault();else return!1})),dbx.addEvent(f,"focus",function(n){var u,t,r;n||(n=window.event);u=dbx.getTarget(n,"dbx-box");(i.keydown||dbx.kde&&!i.mouseisdown)&&(u.className+=" dbx-box-focus");t=dbx.getTarget(n,"dbx-handle");r=i.vocab.kmove;dbx.hasClass(u,"dbx-nograb")?r=t.getAttribute("oldtitle"):dbx.empty(t.getAttribute("oldtitle"))||(r=i.vocab.syntax.replace(/%mytitle[%]?/,t.getAttribute("oldtitle")).replace(/%dbxtitle[%]?/,r));dbx.empty(r)||i.createTooltip(r,t,i.keydown||dbx.kde&&!i.mouseisdown);t.hasfocus!==null&&(t.hasfocus=!0)}),dbx.addEvent(f,"blur",function(n){n||(n=window.event);dbx.removeClass(dbx.getTarget(n,"dbx-box"),"dbx-box-focus");i.removeTooltip();var t=dbx.getTarget(n,"dbx-handle");t.hasfocus!==null&&(t.hasfocus=!1)}),this.eles[t].hashandlers=!0),typeof this.eles[t].processed!="undefined")continue;s=this.eles[t].getAttribute("title");s&&this.eles[t].setAttribute("oldtitle",s);this.eles[t].style.position="relative";this.eles[t].style.display="block";dbx.hasClass(o,"dbx-nograb")||(this.eles[t].className+=" dbx-handle-cursor",this.eles[t].setAttribute("title",dbx.empty(this.eles[t].getAttribute("title"))?this.vocab.move:this.vocab.syntax.replace(/%mytitle[%]?/,this.eles[t].title).replace(/%dbxtitle[%]?/,this.vocab.move)));this.eles[t].processed=!0}dbx.msie&&dbx.hasClass(this.eles[t],"dbx-(content|box)")&&(this.eles[t].runtimeStyle.zoom="1.0")}if(this.updateChildClasses(),dbx.savedata[this.gid]=this.order.join(","),u=this.container.appendChild(dbx.createElement("span")),u.className="dbx-box dbx-dummy",u.style.display="block",u.style.width="0",u.style.height="0",u.style.overflow="hidden",u.className+=" dbx-offdummy",r=this.boxes.length,typeof dbx.gnumbers[this.gid]!="undefined"&&(r+="_"+dbx.gnumbers[this.gid]),this.boxes[r]=u,this.boxes.length++,n)if(dbx.cookiestate&&typeof dbx.cookiestate[this.gid]!="undefined"){for(h=dbx.cookiestate[this.gid].length,t=0;t<h;t++)e=dbx.cookiestate[this.gid][t].replace(/[\-\+]/g,""),typeof this.boxes[e]!="undefined"&&this.boxes[e]!=u&&(this.container.insertBefore(this.boxes[e],u),this.toggles&&/\-$/.test(dbx.cookiestate[this.gid][t])&&typeof this.buttons[e]!="undefined"&&this.toggleBoxState(this.buttons[e],!1,!1,!0));this.regenerateBoxOrder()}else if(!this.defopen&&this.toggles)for(t in this.buttons)dbx.unwanted(this.buttons,t)||this.toggleBoxState(this.buttons[t],!0,!1,null)};dbxGroup.prototype.cacheDynamicClasses=function(){for(var n=[],i=["dbx-tooltip","dbx-dragclone","dbx-dialog"],t=0;t<i.length;t++)n[t]=dbx.createElement("div"),n[t].className="dbx-clone "+i[t],this.container.appendChild(n[t]);setTimeout(function(){for(var t=0;t<n.length;t++)n[t].parentNode&&n[t].parentNode.removeChild(n[t])},100)};dbxGroup.prototype.addToggleBehavior=function(){for(var n,t=this,r=dbx.get(dbx.buttontype=="link"?"a":"button",arguments[0]),i=0;i<r.length;i++)if(dbx.hasClass(r[i],"dbx-toggle")){n=r[i];break}return typeof n=="undefined"&&(dbx.buttontype=="link"?(n=arguments[0].appendChild(dbx.createElement("a")),n.appendChild(document.createTextNode(" ")),n.href="javascript:void(null)"):n=arguments[0].appendChild(dbx.createElement("button")),n.className="dbx-toggle dbx-toggle-open",n.setAttribute("title",this.vocab.toggle.replace(/%toggle[%]?/,this.vocab.close))),n.style.cursor="pointer",n.hasfocus=dbx.opera||dbx.safari||dbx.chrome?null:!1,this.tooltip=null,typeof n.hashandlers=="undefined"&&(n.onclick=function(n){return t.click(n,this),!1},n["onkey"+(dbx.msie||dbx.safari||dbx.chrome?"down":"press")]=function(n){return n||(n=window.event),t.keypress(n,this)},n.onfocus=function(){var n,r,i,u;for(n in t.buttons)dbx.unwanted(t.buttons,n)||(t.buttons[n]=dbx.removeClass(t.buttons[n],"(dbx-toggle-hilite-)(open|closed)"));r=dbx.hasClass(this,"dbx-toggle-open");this.className+=" dbx-toggle-hilite-"+(r?"open":"closed");(t.keydown||dbx.kde&&!t.mouseisdown)&&(dbx.getTarget(null,"dbx-box",this).className+=" dbx-box-focus");i=(dbx.hasClass(dbx.getTarget(null,"dbx-box",this),"dbx-nograb")?"":t.vocab.kmove)+t.vocab.ktoggle.replace(/%toggle[%]?/,r?t.vocab.close:t.vocab.open);u=dbx.getTarget(null,"dbx-handle",this);dbx.empty(u.getAttribute("oldtitle"))||(i=t.vocab.syntax.replace(/%mytitle[%]?/,u.getAttribute("oldtitle")).replace(/%dbxtitle[%]?/,i));t.createTooltip(i,this,t.keydown||dbx.kde&&!t.mouseisdown);this.isactive=!0;this.hasfocus!==null&&(this.hasfocus=!0)},n.onblur=function(){n=dbx.removeClass(n,"(dbx-toggle-hilite-)(open|closed)");dbx.removeClass(dbx.getTarget(null,"dbx-box",this),"dbx-box-focus");t.removeTooltip();this.hasfocus!==null&&(this.hasfocus=!1)},n.hashandlers=!0),n};dbxGroup.prototype.toggleBoxState=function(n,t,i,r){var u=dbx.hasClass(n,"dbx-toggle-open"),f,e;(r!==null&&(u=r),f=dbx.getTarget(null,"dbx-box",n),dbx.sourcebox=f,dbx.toggle=n,dbx.dbxobject=this,dbx.group=typeof dbx.container=="undefined"?dbx.getTarget(null,"dbx-group",f):dbx.container,typeof dbx.onbeforestatechange=="undefined"||(e=dbx.compileAndDispatchOnBeforeStateChange(["proceed",this,this.container,this.gid,f,n,u?"close":"open"]),e.proceed))&&(i==!1||!u&&(typeof dbx.onboxopen=="undefined"||dbx.onboxopen())||u&&(typeof dbx.onboxclose=="undefined"||dbx.onboxclose()))&&(n.className="dbx-toggle dbx-toggle-"+(u?"closed":"open"),n.title=this.vocab.toggle.replace(/%toggle[%]?/,u?this.vocab.open:this.vocab.close),i&&typeof n.isactive!="undefined"&&(n.className+=" dbx-toggle-hilite-"+(u?"closed":"open")),f.className=f.className.replace(/[ ](dbx-box-)(open|closed)/," $1"+(u?"closed":"open")),t&&this.regenerateBoxOrder())};dbxGroup.prototype.moveBoxByKeyboard=function(n,t,i,r,u,f){var a,e,y,p,h,o,c,s,d,w;dbx.dbxobject=this;dbx.group=this.container;dbx.gid=this.gid;dbx.sourcebox=i;dbx.clonebox=null;dbx.event=n;a="-";this.positive=/[se]/i.test(r);/^(Sw)$/.test(r)&&(this.positive=!1);this.removeActiveClasses("dbx-box-(target|active)");var b={x:i.offsetLeft,y:i.offsetTop},v=[],l=this.boxes;for(e in l)dbx.unwanted(l,e)||dbx.hasClass(l[e],"dbx-dummy")||(y={x:l[e].offsetLeft,y:l[e].offsetTop},v.push([e,y.x-b.x,y.y-b.y]),i==l[e]&&(a=e));for(p={positive:[],negative:[]},h=/[ew]/i.test(r)?1:2,e=0;e<v.length;e++)v[e][0]!=a&&(v[e][h]>=0?p.positive.push(v[e]):p.negative.push(v[e]));for(o=this.positive?p.positive:p.negative,o.sort(function(n,t){return Math.abs(n[h])-Math.abs(t[h])}),e=0;e<o.length;e++)o[e][h]==0&&o.splice(e--,1);if(r.length>1)for(e=0;e<o.length;e++)(/[ew]/i.test(r)&&o[e][2]==0||/[ns]/i.test(r)&&o[e][1]==0||/(N[ew])/.test(r)&&o[e][2]>0||/(S[ew])/.test(r)&&o[e][2]<0)&&o.splice(e--,1);for(e=0;e<o.length;e++)this.positive?e>0&&Math.abs(o[e][h])!=Math.abs(o[0][h])&&o.splice(e--,1):e>0&&o[e][h]!=o[0][h]&&o.splice(e--,1);if(h=h==1?2:1,o.sort(function(n,t){return Math.abs(n[h])-Math.abs(t[h])}),a=o.length==0?"-":o[0][0],c=dbx.getTarget(null,"dbx-box",t),a=="-")return!1;if(s=l[a],this.exchange=="insert"&&this.confirm==!1&&this.positive==!0&&(s=dbx.get("nextSibling",s),s||(s=l[a])),typeof dbx.onboxdrag=="undefined"||dbx.onboxdrag()){if(c!=s&&l==this.boxes){var k={x:c.offsetLeft+c.offsetWidth/2,y:c.offsetTop+c.offsetHeight/2},y={x:s.offsetLeft+s.offsetWidth/2,y:s.offsetTop+s.offsetHeight/2},tt=this.getBlocksDifference(k,y,c),it=this.getCompassDirection(k,y);if(this.functionExists("_testRules")&&!this._testRules(it,tt,c,null))return(u||this.dialog)&&(this.updateDialog(s," dbx-dialog-no",null,null,"keyboard"),this.vocab.kno!=""&&this.createTooltip(this.vocab.kno,c,!0)),f&&this.refocus(t),!1}if(c==s||dbx.hasClass(s,"dbx-(dialog|dummy)")||(s.className+=" dbx-box-target"),u||this.dialog){if(d=null,w=null,l!=this.boxes){w=this.dialog.group;var g=dbx.getPosition(w.container,!1),nt=dbx.getPosition(this.container,!1),d={x:g.left-nt.left,y:g.top-nt.top}}return this.updateDialog(s," dbx-dialog-yes",d,w,"keyboard"),this.vocab.kyes!=""&&this.createTooltip(this.vocab.kyes,c,!0),f&&this.refocus(t),!1}return this.exchange=="swap"?this.swapTwoBoxes(i,s,t,f,this.positive):this.insertTwoBoxes(i,s,t,f,r)}return!1};dbxGroup.prototype.insertTwoBoxes=function(n,t,i,r){var s,u,o,h;if(typeof dbx.onbeforestatechange!="undefined"&&(s=dbx.compileAndDispatchOnBeforeStateChange(["proceed",this,this.container,this.gid,n,t,"insert"]),!s.proceed))return!1;this.functionExists("_updateRulePointer")&&this._updateRulePointer();var e=[],f=[];for(u in this.boxes)dbx.unwanted(this.boxes,u)||e.push(this.boxes[u]);for(u=0;u<e.length;u++)e[u]!=n&&f.push(e[u]);for(o=[],u=0;u<f.length;u++)o.push({x:f[u].offsetLeft,y:f[u].offsetTop});if(h={x:n.offsetLeft,y:n.offsetTop},n.style.visibility="hidden",t=dbx.removeClass(t,"dbx-box-target"),t.parentNode.insertBefore(n,t),typeof f!="undefined"&&f.length>0)for(u=0;u<f.length;u++)new dbxAnimator(this,f[u],o[u],this.resolution,!1,null,!0);return new dbxAnimator(this,n,h,this.resolution,!0,i,r),this.regenerateBoxOrder(),!0};dbxGroup.prototype.swapTwoBoxes=function(n,t,i,r,u){var e,o,s,f;return typeof dbx.onbeforestatechange!="undefined"&&(e=dbx.compileAndDispatchOnBeforeStateChange(["proceed",this,this.container,this.gid,n,this.orientation!="freeform"&&u?dbx.getSiblingBox(t,"nextSibling"):t,this.orientation=="freeform"?"swap":"move"]),!e.proceed)?!1:(this.functionExists("_updateRulePointer")&&this._updateRulePointer(),o={x:t.offsetLeft,y:t.offsetTop},s={x:n.offsetLeft,y:n.offsetTop},n.style.visibility="hidden",t.style.visibility="hidden",t=dbx.removeClass(t,"dbx-box-target"),f=t.nextSibling,f==n?t.parentNode.insertBefore(n,t):(n.parentNode.insertBefore(t,n),f.parentNode.insertBefore(n,f)),new dbxAnimator(this,t,o,this.resolution,!0,null,!1),new dbxAnimator(this,n,s,this.resolution,!0,i,r),this.regenerateBoxOrder(),!0)};dbxGroup.prototype.createTooltip=function(n,t,i){var r,u;if(i){this.tooltip=this.container.appendChild(dbx.createElement("span"));this.tooltip.style.visibility="hidden";this.tooltip.className="dbx-tooltip";this.tooltip.appendChild(document.createTextNode(n));r=dbx.getTarget(null,"dbx-box",t);this.tooltip.style.left=parseInt(r.offsetLeft,10)+"px";this.tooltip.style.top=parseInt(r.offsetTop,10)+"px";var f=dbx.getPosition(this.tooltip),e=dbx.getViewportWidth(),o=this.tooltip.offsetWidth;f.left+o>e&&(this.tooltip.style.left=parseInt(r.offsetLeft-(f.left+o-e),10)+"px");u=this.tooltip;window.setTimeout(function(){u!=null&&(u.style.visibility="visible")},400)}};dbxGroup.prototype.removeTooltip=function(){this.tooltip&&(this.tooltip.parentNode.removeChild(this.tooltip),this.tooltip=null)};dbxGroup.prototype.hover=function(n){var r,u,t,i;if(!this.keydown||dbx.kde&&!this.mouseisdown){for(r=!1,u=typeof n.target!="undefined"?n.target:n.srcElement,t=0;t<this.handles.length;t++)if(this.contains(this.handles[t],u)){r=!0;i=dbx.getTarget(null,"dbx-box",this.handles[t]);dbx.hasClass(i,"dbx-box-hover")||(typeof this.hoverbox!="undefined"&&(this.hoverbox=dbx.removeClass(this.hoverbox,"dbx-box-hover")),this.hoverbox=i,i.className+=" dbx-box-hover");break}r||typeof this.hoverbox!="undefined"&&(this.hoverbox=dbx.removeClass(this.hoverbox,"dbx-box-hover"),delete this.hoverbox)}};dbxGroup.prototype.refresh=function(n){if(dbx.supported){typeof n=="undefined"&&(n=!1);this.eles=dbx.get("*",this.container);for(var t=0;t<this.eles.length;t++)dbx.hasClass(this.eles[t],"dbx-dummy")&&this.container.removeChild(this.eles[t]);this.initBoxes(n,!0);this.regenerateBoxOrder()}};dbxGroup.prototype.functionExists=function(n){return typeof this[n]=="function"};dbxGroup.prototype.mousedown=function(n,t,i,r){var u=typeof i!="undefined"?i:typeof n.target!="undefined"?n.target:n.srcElement;if(u.nodeName=="#text"&&(u=u.parentNode),!dbx.hasClass(u,"dbx-(toggle|box|group)"))while(!dbx.hasClass(u,"dbx-(handle|box|group)"))u=u.parentNode;dbx.hasClass(u,"dbx-(toggle|handle)")&&(t.className+=" dbx-box-active");!dbx.hasClass(t,"dbx-nograb")&&dbx.hasClass(u,"dbx-handle")&&(this.clearDialog(),t=dbx.removeClass(t,"dbx-box-focus"),this.removeTooltip(),this.released=!1,this.initial={x:n.clientX,y:n.clientY},typeof r!="undefined"&&(this.initial.x+=0-r.x,this.initial.y+=0-r.y),this.current={x:0,y:0},this.createCloneBox(t,"mouse"),typeof n.preventDefault!="undefined"&&n.preventDefault(),typeof document.onselectstart!="undefined"&&(document.onselectstart=function(){return!1}))};dbxGroup.prototype.mousemove=function(n){var t;if(!this.dragok&&this.dialog&&this.dialog.source!="keyboard"&&(this.clearDialog(),this.removeTooltip(),this.removeActiveClasses("dbx-box-(target|active)")),this.dragok&&this.box&&(this.direction=n.clientY==this.current.y?n.clientX>this.current.x?"right":"left":n.clientY>this.current.y?"down":"up",this.current={x:n.clientX,y:n.clientY},t={x:this.current.x-this.initial.x,y:this.current.y-this.initial.y},(t.x>=0&&t.x<=this.threshold||t.x<=0&&t.x>=0-this.threshold)&&(t.y>=0&&t.y<=this.threshold||t.y<=0&&t.y>=0-this.threshold)&&(this.current.x-=t.x,this.current.y-=t.y),(this.released||t.x>this.threshold||t.x<0-this.threshold||t.y>this.threshold||t.y<0-this.threshold)&&(dbx.dbxobject=this,dbx.group=this.container,dbx.sourcebox=this.box,dbx.clonebox=this.boxclone,dbx.event=n,typeof dbx.onboxdrag=="undefined"||dbx.onboxdrag()))){if(this.released=!0,(this.restrict!="vertical"||this.orientation=="horizontal")&&(this.boxclone.style.left=parseInt(this.current.x-this.difference.x,10)+"px"),(this.restrict!="horizontal"||this.orientation=="vertical")&&(this.boxclone.style.top=parseInt(this.current.y-this.difference.y,10)+"px"),this.restrict=="freeform"){var i={x:this.boxclone.offsetLeft+this.boxclone.offsetWidth/2,y:this.boxclone.offsetTop+this.boxclone.offsetHeight/2},r=.2,u=Math.round(Math.sqrt(Math.pow(this.boxclone.offsetWidth,2)+Math.pow(this.boxclone.offsetHeight,2)));if(i.x<0||i.x>this.container.offsetWidth-r*u||i.y<0||i.y>this.container.offsetHeight-r*u)return this.mouseup(n),!0}this.moveBoxByMouse(this.current.x,this.current.y,this.confirm);typeof n.preventDefault!="undefined"&&n.preventDefault()}return!0};dbxGroup.prototype.mouseup=function(n){if(this.removeActiveClasses("dbx-box-(target|active)"),this.box){if(this.dialog){if(typeof this.dialog.group!="undefined"&&typeof this.boxes[dbx.getID(this.dialog)]=="undefined")var t=this.dialog.group,i=t.boxes[dbx.getID(this.dialog)];if(this.clearDialog(),typeof t!="undefined"){dbx.mousemove(n,this,t,i);return}this.moveBoxByMouse(n.clientX,n.clientY,!1)}this.removeCloneBox();this.regenerateBoxOrder();typeof document.onselectstart!="undefined"&&(document.onselectstart=function(){return!0})}this.clearDialog();this.dragok=!1};dbxGroup.prototype.click=function(n,t){var f;if(t.hasfocus===!0||t.hasfocus===null){if(this.dialog){var r=dbx.getTarget(null,"dbx-box",t),u=dbx.getID(this.dialog),i=this.boxes[u];if(this.exchange=="insert"&&this.confirm==!0&&this.positive==!0&&(i=dbx.get("nextSibling",i),i||(i=this.boxes[u])),f=dbx.hasClass(this.dialog,"dbx-dialog-yes"),this.clearDialog(),this.removeTooltip(),typeof i!="undefined"&&i!=r&&f==!0)if(this.exchange=="swap")this.swapTwoBoxes(r,i,t,!0,!1);else return this.insertTwoBoxes(r,i,t,!0,!1);return!1}this.removeTooltip();this.toggleBoxState(t,!0,!0,null)}return!1};dbxGroup.prototype.keypress=function(n,t){var f=dbx.getTarget(null,"dbx-box",t),i,u,r;if(/^(3[7-9])|(40)$/.test(n.keyCode.toString())){if(dbx.opera&&n.shiftKey)return!0;if(!dbx.hasClass(dbx.getTarget(null,"dbx-box",t),"dbx-nograb")){f.className+=" dbx-box-active";this.removeTooltip();i="";switch(n.keyCode){case 37:i="W";break;case 38:i="N";break;case 39:i="E";break;case 40:i="S"}if(u=75,this.currentdir&&this.currentdir!=i){i+=this.currentdir.toLowerCase();switch(i){case"En":i="Ne";break;case"Es":i="Se";break;case"Wn":i="Nw";break;case"Ws":i="Sw"}clearTimeout(this.keytimer);u=0}else this.currentdir=i;if(r=this,this.keytimer=setTimeout(function(){if(!/^(Ns|Sn|Ew|Ww)$/.test(i)){if(r.dialog)var f=dbx.getID(r.dialog),u=r.boxes[f];else u=dbx.getTarget(null,"dbx-box",t);r.moveBoxByKeyboard(n,t,u,i,r.confirm,!0)}},u),typeof n.preventDefault!="undefined")n.preventDefault();else return!1;typeof n.stopPropagation!="undefined"?n.stopPropagation():n.cancelBubble=!0;this.keydown=!1}}else dbx.kde&&n.target==t&&(n.keyCode==13||n.keyCode==32)?(this.click(n,t),n.preventDefault()):this.removeActiveClasses("dbx-box-(target|active)");return(n.keyCode==13||n.keyCode==32)&&(f.className+=" dbx-box-active"),!0};dbxGroup.prototype.regenerateBoxOrder=function(){var t,n;for(this.order=[],t=this.eles.length,n=0;n<t;n++)dbx.hasClass(this.eles[n],"dbx-box")&&!dbx.hasClass(this.eles[n],"dbx-(clone|dummy)")&&this.order.push(dbx.getID(this.eles[n])+(dbx.hasClass(this.eles[n],"dbx-box-open")?"+":"-"));dbx.savedata[this.gid]=this.order.join(",");dbx.dbxobject=this;dbx.group=this.container;dbx.gid=this.gid;this.updateChildClasses();dbx.setCookieState()};dbxGroup.prototype.updateChildClasses=function(){for(var r,u,t=[],i=dbx.get("*",this.container),n=0;n<i.length;n++)dbx.hasClass(i[n],"dbx-box")&&!dbx.hasClass(i[n],"dbx-(dummy|clone)")&&t.push(dbx.getID(i[n]));r={first:t[0],last:t[t.length-1]};for(n in r)dbx.unwanted(r,n)||(u=this.boxes[r[n]],this.child[n]!=null&&(this.child[n]=dbx.removeClass(this.child[n],n+"-child"),this.boxclone&&dbx.getID(this.boxclone)==dbx.getID(this.child[n])&&(this.boxclone=dbx.removeClass(this.boxclone,n+"-child")),this.child[n]=null),u.className+=" "+n+"-child",this.child[n]=u,this.boxclone&&dbx.getID(this.boxclone)==dbx.getID(this.child[n])&&(this.boxclone.className+=" "+n+"-child"))};dbxGroup.prototype.createClone=function(n,t,i,r,u,f){var e=this.container.appendChild(n.cloneNode(u));return e.source=f,e.className+=" dbx-clone",r!=""&&(e.className+=" "+r),e=dbx.removeClass(e,"dbx-box-focus"),e.style.position="absolute",e.style.visibility="hidden",e.style.zIndex=t,e.style.left=parseInt(i.x,10)+"px",e.style.top=parseInt(i.y,10)+"px",e.style.width=n.offsetWidth+"px",e.style.height=n.offsetHeight+"px",e};dbxGroup.prototype.createCloneBox=function(n,t){this.box=n;this.position={x:this.box.offsetLeft,y:this.box.offsetTop};this.difference={x:this.initial.x-this.position.x,y:this.initial.y-this.position.y};this.boxclone=this.createClone(this.box,3e4,this.position,"dbx-dragclone",!0,t);this.boxclone.style.cursor="move";this.dragok=!0};dbxGroup.prototype.removeCloneBox=function(){this.container.removeChild(this.boxclone);this.box.style.visibility="visible";this.box=null};dbxGroup.prototype.removeActiveClasses=function(n){for(var t in this.boxes)dbx.unwanted(this.boxes,t)||(this.boxes[t]=dbx.removeClass(this.boxes[t],n))};dbxGroup.prototype.moveBoxByMouse=function(n,t,i){var s,c,h,l,e,d,v,y,p,g,tt,it,f,u,rt,r,a,nt,ut,b,k;this.orientation=="freeform"?(s={x:n-this.difference.x+this.boxclone.offsetWidth/2,y:t-this.difference.y+this.boxclone.offsetHeight/2},c=[]):h={xy:this.orientation=="vertical"?t-this.difference.y:n-this.difference.x,wh:this.orientation=="vertical"?this.boxclone.offsetHeight:this.boxclone.offsetWidth};dbx.hide&&(this.box.style.visibility="hidden");this.removeActiveClasses("dbx-box-(target|active)");this.boxclone.style.visibility="visible";for(r in this.boxes)if(!dbx.unwanted(this.boxes,r))if(this.orientation=="freeform"){if(dbx.hasClass(this.boxes[r],"dbx-dummy")&&this.exhange=="swap")continue;l={x:this.boxes[r].offsetLeft+this.boxes[r].offsetWidth/2,y:this.boxes[r].offsetTop+this.boxes[r].offsetHeight/2};c.push([r,Math.round(Math.sqrt(Math.pow(Math.abs(s.x-l.x),2)+Math.pow(Math.abs(s.y-l.y),2)))]);this.boxes[r]==this.box&&(c[c.length-1][1]=Math.pow(10,20),(i||this.dialog)&&this.updateDialog(this.box,"",null,null,"mouse"))}else if(e={xy:this.orientation=="vertical"?this.boxes[r].offsetTop:this.boxes[r].offsetLeft,wh:this.orientation=="vertical"?this.boxes[r].offsetHeight:this.boxes[r].offsetWidth},this.positive=this.direction=="down"||this.direction=="right",this.positive&&h.xy+h.wh>e.xy&&h.xy<e.xy||!this.positive&&h.xy<e.xy&&h.xy+h.wh>e.xy){if(this.boxes[r]==this.box)return;if(d=dbx.getSiblingBox(this.box,"nextSibling"),this.box==d||this.boxes[r]==d)return;v=r;break}if(this.orientation=="freeform"){if(c.sort(function(n,t){return n[1]-t[1]}),v=c[0][0],f=this.boxes[v],u=f,this.exchange=="insert"&&(this.direction=="down"||this.direction=="right")&&(f=dbx.get("nextSibling",f)),f==this.box)return;if(e={left:u.offsetLeft,top:u.offsetTop},e.right=e.left+f.offsetWidth,e.bottom=e.top+f.offsetHeight,y=i||this.dialog?0:.1,p=Math.round(Math.sqrt(Math.pow(u.offsetWidth,2)+Math.pow(u.offsetHeight,2))),!(s.x>e.left+p*y&&s.x<e.right-p*y&&s.y>e.top+p*y&&s.y<e.bottom-p*y))return;if(this.last.box==f&&this.last.direction==this.direction)return;if(g={x:this.box.offsetLeft+this.box.offsetWidth/2,y:this.box.offsetTop+this.box.offsetHeight/2},l={x:u.offsetLeft+u.offsetWidth/2,y:u.offsetTop+u.offsetHeight/2},tt=this.getBlocksDifference(g,l,this.box),it=this.getCompassDirection(g,l),this.functionExists("_testRules")&&!this._testRules(it,tt,this.box,null)){(i||this.dialog)&&this.updateDialog(u," dbx-dialog-no",null,null,"mouse");return}if(i||this.dialog){dbx.hasClass(f,"dbx-(dialog|dummy)")||(u.className+=" dbx-box-target");this.updateDialog(u," dbx-dialog-yes",null,null,"mouse");return}this.functionExists("_updateRulePointer")&&this._updateRulePointer();this.last={box:u,direction:this.direction}}else f=this.boxes[v],u=f;if(typeof v!="undefined"&&(dbx.hasClass(u,"dbx-(dialog|dummy)")||(u.className+=" dbx-box-target"),typeof dbx.onbeforestatechange=="undefined"||(rt=dbx.compileAndDispatchOnBeforeStateChange(["proceed",this,this.container,this.gid,this.box,u,this.orientation=="freeform"?this.exchange:"move"]),rt.proceed))){if(this.orientation=="freeform")if(this.exchange=="swap")a=u;else{var w=[],o=[];for(r in this.boxes)dbx.unwanted(this.boxes,r)||w.push(this.boxes[r]);for(r=0;r<w.length;r++)w[r]!=this.box&&o.push(w[r])}else a=this.positive?dbx.getSiblingBox(f,"previousSibling"):f;if(typeof o!="undefined")for(nt=[],r=0;r<o.length;r++)nt.push({x:o[r].offsetLeft,y:o[r].offsetTop});else ut={x:a.offsetLeft,y:a.offsetTop};if(u=dbx.removeClass(u,"dbx-box-target"),b={x:this.box.offsetLeft,y:this.box.offsetTop},this.orientation=="freeform"&&this.exchange=="swap"?(k=f.nextSibling,k==this.box?f.parentNode.insertBefore(this.box,f):(this.box.parentNode.insertBefore(f,this.box),k.parentNode.insertBefore(this.box,k))):this.container.insertBefore(this.box,f),this.updateChildClasses(),this.initial.x+=this.box.offsetLeft-b.x,this.initial.y+=this.box.offsetTop-b.y,typeof o!="undefined"&&o.length>0)for(r=0;r<o.length;r++)new dbxAnimator(this,o[r],nt[r],this.resolution,!1,null,!0);else a!=this.box&&new dbxAnimator(this,a,ut,this.resolution,!1,null,!0);this.confirm||dbx.hide||new dbxAnimator(this,this.box,b,this.resolution,!1,null,!0)}};dbxGroup.prototype.getCompassDirection=function(n,t){var i=n.y<t.y?"S":"N";return n.y==t.y?i=n.x<t.x?"E":"W":n.x<t.x?i+="e":n.x>t.x&&(i+="w"),i};dbxGroup.prototype.getBlocksDifference=function(n,t,i){var r=[parseInt(Math.abs(n.x-t.x)/i.offsetWidth,10),parseInt(Math.abs(n.y-t.y)/i.offsetHeight,10)];return r.sort(function(n,t){return n-t}),r};dbxGroup.prototype.updateDialog=function(n,t,i,r,u){this.buffer&&(clearTimeout(this.buffer),this.buffer=null);var f=this;this.buffer=setTimeout(function(){var r={x:n.offsetLeft,y:n.offsetTop};i&&(r.x+=i.x,r.y+=i.y);f.clearDialog();f.dialog=f.createClone(n,29999,r,"dbx-dialog"+t,!1,u);f.dialog=dbx.removeClass(f.dialog,"dbx-box-(target|active|hover|focus)");f.dialog.style.visibility="visible";clearTimeout(f.buffer);f.buffer=null},20)};dbxGroup.prototype.clearDialog=function(){this.dialog&&(this.container.removeChild(this.dialog),this.dialog=null)};dbxGroup.prototype.contains=function(n,t){return t==n?!0:t==null?!1:this.contains(n,t.parentNode)};dbxGroup.prototype.refocus=function(n){try{n.focus()}catch(i){}var t=dbx.getTarget(null,"dbx-box",n);dbx.hasClass(t,"dbx-box-focus")||(t.className+=" dbx-box-focus")};dbxAnimator.prototype.animateClone=function(n,t,i,r,u,f,e){var o=this,s=0;dbx.running++;this.timer=window.setInterval(function(){if(s++,t.x+=i.x/r,t.y+=i.y/r,n.style.left=parseInt(t.x,10)+"px",n.style.top=parseInt(t.y,10)+"px",s==r){if(window.clearInterval(o.timer),o.timer=null,dbx.running--,o.caller.container.removeChild(n),o.box.style.visibility="visible",o.box.className.indexOf("dbxid")!=-1&&(o.box=dbx.removeClass(o.box,"dbx-dummy")),o.caller.boxes[dbx.getID(o.box)]=o.box,u&&e)if(f&&f.parentNode.style.visibility!="hidden")setTimeout(function(){o.caller.refocus(f)},0);else if(o.caller.toggles){var h=o.caller.buttons[dbx.getID(o.box)];h&&typeof h.isactive!="undefined"&&o.caller.refocus(h)}else typeof o.box.focus=="function"&&setTimeout(function(){o.caller.refocus(o.box)},0);typeof dbx.onafteranimate=="function"&&setTimeout(function(){dbx.compileAndDispatchOnAfterAnimate(o.box,o.caller)},0)}typeof dbx.onanimate=="function"&&o.caller.resolution>1&&dbx.compileAndDispatchOnAnimate(o.box,n,o.caller,s,r)},20)};typeof attachEvent!="undefined"&&window.attachEvent("onunload",function(){for(var n,i=["mousedown","mousemove","mouseup","mouseout","click","keydown","keyup","focus","blur","selectstart","statechange","boxdrag","boxopen","boxclose","ruletest","afteranimate","beforestatechange"],r=i.length,u=document.all.length,t=0;t<u;t++)for(n=0;n<r;n++)document.all[t]["on"+i[n]]=null});
/*
//# sourceMappingURL=dbx.min.js.map
*/